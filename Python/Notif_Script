import subprocess
import os
import sys

if len(sys.argv) != 4:
    print("Usage: python Notif_script.py [job_name] [server_name] [user_name]")
    sys.exit(1)

job_name=sys.argv[1]
if job_name.endswith(".inp"):
    job_name=job_name.removesuffix('.inp')
server_name=sys.argv[2]
user_name=sys.argv[3]

script=f"""nohup bash -c ' molpro {job_name}.inp > {job_name}.log 2>&1 
python3 - <<EOF 
import requests 
requests.post("https://ntfy.sh/budakalaszmajalis2006", data="{job_name} by {user_name} is finished on {server_name}") 
EOF
' &
"""

subprocess.run(script, shell=True, executable="/bin/bash")
